import { __decorate } from "tslib";
import { Injectable } from '@angular/core';
import { createFrom, EventService, ProductSearchService, ProductService, } from '@spartacus/core';
import { EMPTY } from 'rxjs';
import { filter, map, skip, switchMap, take } from 'rxjs/operators';
import { PageEvent } from '../page/page.events';
import { CategoryPageResultsEvent, ProductDetailsPageEvent, SearchPageResultsEvent, } from './product-page.events';
import * as i0 from "@angular/core";
import * as i1 from "@spartacus/core";
let ProductPageEventBuilder = class ProductPageEventBuilder {
    constructor(eventService, productService, productSearchService) {
        this.eventService = eventService;
        this.productService = productService;
        this.productSearchService = productSearchService;
        this.register();
    }
    register() {
        this.eventService.register(SearchPageResultsEvent, this.buildSearchPageResultsEvent());
        this.eventService.register(ProductDetailsPageEvent, this.buildProductDetailsPageEvent());
        this.eventService.register(CategoryPageResultsEvent, this.buildCategoryResultsPageEvent());
    }
    buildProductDetailsPageEvent() {
        return this.eventService.get(PageEvent).pipe(filter((pageEvent) => pageEvent.semanticRoute === 'product'), map((pageEvent) => pageEvent.context.id), switchMap((productId) => this.productService.get(productId).pipe(filter((product) => Boolean(product)), take(1), map((product) => createFrom(ProductDetailsPageEvent, {
            categories: product.categories,
            code: product.code,
            name: product.name,
            price: product.price,
        })))));
    }
    buildCategoryResultsPageEvent() {
        const searchResults$ = this.productSearchService.getResults().pipe(
        // skipping the initial value, and preventing emission of the previous search state
        skip(1));
        const categoryPageEvent$ = this.eventService.get(PageEvent).pipe(map((pageEvent) => ({
            isCategoryPage: pageEvent.semanticRoute === 'category',
            categoryCode: pageEvent.context.id,
        })));
        return categoryPageEvent$.pipe(switchMap((pageEvent) => {
            if (!pageEvent.isCategoryPage) {
                return EMPTY;
            }
            return searchResults$.pipe(map((searchResults) => ({
                categoryCode: pageEvent.categoryCode,
                categoryName: searchResults.breadcrumbs[0].facetValueName,
            })), map((categoryPage) => createFrom(CategoryPageResultsEvent, categoryPage)));
        }));
    }
    buildSearchPageResultsEvent() {
        const searchResults$ = this.productSearchService.getResults().pipe(
        // skipping the initial value, and preventing emission of the previous search state
        skip(1), map((searchResults) => ({
            searchTerm: searchResults.freeTextSearch,
            numberOfResults: searchResults.pagination.totalResults,
        })), map((searchPage) => createFrom(SearchPageResultsEvent, searchPage)));
        const searchPageEvent$ = this.eventService
            .get(PageEvent)
            .pipe(map((pageEvent) => pageEvent.semanticRoute === 'search'));
        return searchPageEvent$.pipe(switchMap((isSearchPage) => (isSearchPage ? searchResults$ : EMPTY)));
    }
};
ProductPageEventBuilder.ctorParameters = () => [
    { type: EventService },
    { type: ProductService },
    { type: ProductSearchService }
];
ProductPageEventBuilder.ɵprov = i0.ɵɵdefineInjectable({ factory: function ProductPageEventBuilder_Factory() { return new ProductPageEventBuilder(i0.ɵɵinject(i1.EventService), i0.ɵɵinject(i1.ProductService), i0.ɵɵinject(i1.ProductSearchService)); }, token: ProductPageEventBuilder, providedIn: "root" });
ProductPageEventBuilder = __decorate([
    Injectable({
        providedIn: 'root',
    })
], ProductPageEventBuilder);
export { ProductPageEventBuilder };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvZHVjdC1wYWdlLWV2ZW50LmJ1aWxkZXIuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Ac3BhcnRhY3VzL3N0b3JlZnJvbnQvIiwic291cmNlcyI6WyJldmVudHMvcHJvZHVjdC9wcm9kdWN0LXBhZ2UtZXZlbnQuYnVpbGRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQ0wsVUFBVSxFQUNWLFlBQVksRUFDWixvQkFBb0IsRUFDcEIsY0FBYyxHQUNmLE1BQU0saUJBQWlCLENBQUM7QUFDekIsT0FBTyxFQUFFLEtBQUssRUFBYyxNQUFNLE1BQU0sQ0FBQztBQUN6QyxPQUFPLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3BFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUNoRCxPQUFPLEVBQ0wsd0JBQXdCLEVBQ3hCLHVCQUF1QixFQUN2QixzQkFBc0IsR0FDdkIsTUFBTSx1QkFBdUIsQ0FBQzs7O0FBSy9CLElBQWEsdUJBQXVCLEdBQXBDLE1BQWEsdUJBQXVCO0lBQ2xDLFlBQ1ksWUFBMEIsRUFDMUIsY0FBOEIsRUFDOUIsb0JBQTBDO1FBRjFDLGlCQUFZLEdBQVosWUFBWSxDQUFjO1FBQzFCLG1CQUFjLEdBQWQsY0FBYyxDQUFnQjtRQUM5Qix5QkFBb0IsR0FBcEIsb0JBQW9CLENBQXNCO1FBRXBELElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNsQixDQUFDO0lBRVMsUUFBUTtRQUNoQixJQUFJLENBQUMsWUFBWSxDQUFDLFFBQVEsQ0FDeEIsc0JBQXNCLEVBQ3RCLElBQUksQ0FBQywyQkFBMkIsRUFBRSxDQUNuQyxDQUFDO1FBQ0YsSUFBSSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQ3hCLHVCQUF1QixFQUN2QixJQUFJLENBQUMsNEJBQTRC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QUMsVUFBVSxDQUFDLHNCQUFzQixFQUFFLFVBQVUsQ0FBQyxDQUFDLENBQ3BFLENBQUM7UUFFRixNQUFNLGdCQUFnQixHQUFHLElBQUksQ0FBQyxZQUFZO2FBQ3ZDLEdBQUcsQ0FBQyxTQUFTLENBQUM7YUFDZCxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsU0FBUyxFQUFFLEVBQUUsQ0FBQyxTQUFTLENBQUMsYUFBYSxLQUFLLFFBQVEsQ0FBQyxDQUFDLENBQUM7UUFFbEUsT0FBTyxnQkFBZ0IsQ0FBQyxJQUFJLENBQzFCLFNBQVMsQ0FBQyxDQUFDLFlBQVksRUFBRSxFQUFFLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FDckUsQ0FBQztJQUNKLENBQUM7Q0FDRixDQUFBOztZQWxHMkIsWUFBWTtZQUNWLGNBQWM7WUFDUixvQkFBb0I7OztBQUozQyx1QkFBdUI7SUFIbkMsVUFBVSxDQUFDO1FBQ1YsVUFBVSxFQUFFLE1BQU07S0FDbkIsQ0FBQztHQUNXLHVCQUF1QixDQW9HbkM7U0FwR1ksdUJBQXVCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtcbiAgY3JlYXRlRnJvbSxcbiAgRXZlbnRTZXJ2aWNlLFxuICBQcm9kdWN0U2VhcmNoU2VydmljZSxcbiAgUHJvZHVjdFNlcnZpY2UsXG59IGZyb20gJ0BzcGFydGFjdXMvY29yZSc7XG5pbXBvcnQgeyBFTVBUWSwgT2JzZXJ2YWJsZSB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZmlsdGVyLCBtYXAsIHNraXAsIHN3aXRjaE1hcCwgdGFrZSB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IFBhZ2VFdmVudCB9IGZyb20gJy4uL3BhZ2UvcGFnZS5ldmVudHMnO1xuaW1wb3J0IHtcbiAgQ2F0ZWdvcnlQYWdlUmVzdWx0c0V2ZW50LFxuICBQcm9kdWN0RGV0YWlsc1BhZ2VFdmVudCxcbiAgU2VhcmNoUGFnZVJlc3VsdHNFdmVudCxcbn0gZnJvbSAnLi9wcm9kdWN0LXBhZ2UuZXZlbnRzJztcblxuQEluamVjdGFibGUoe1xuICBwcm92aWRlZEluOiAncm9vdCcsXG59KVxuZXhwb3J0IGNsYXNzIFByb2R1Y3RQYWdlRXZlbnRCdWlsZGVyIHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHJvdGVjdGVkIGV2ZW50U2VydmljZTogRXZlbnRTZXJ2aWNlLFxuICAgIHByb3RlY3RlZCBwcm9kdWN0U2VydmljZTogUHJvZHVjdFNlcnZpY2UsXG4gICAgcHJvdGVjdGVkIHByb2R1Y3RTZWFyY2hTZXJ2aWNlOiBQcm9kdWN0U2VhcmNoU2VydmljZVxuICApIHtcbiAgICB0aGlzLnJlZ2lzdGVyKCk7XG4gIH1cblxuICBwcm90ZWN0ZWQgcmVnaXN0ZXIoKTogdm9pZCB7XG4gICAgdGhpcy5ldmVudFNlcnZpY2UucmVnaXN0ZXIoXG4gICAgICBTZWFyY2hQYWdlUmVzdWx0c0V2ZW50LFxuICAgICAgdGhpcy5idWlsZFNlYXJjaFBhZ2VSZXN1bHRzRXZlbnQoKVxuICAgICk7XG4gICAgdGhpcy5ldmVudFNlcnZpY2UucmVnaXN0ZXIoXG4gICAgICBQcm9kdWN0RGV0YWlsc1BhZ2VFdmVudCxcbiAgICAgIHRoaXMuYnVpbGRQcm9kdWN0RGV0YWlsc1BhZ2VFdmVudCgpXG4gICAgKTtcbiAgICB0aGlzLmV2ZW50U2VydmljZS5yZWdpc3RlcihcbiAgICAgIENhdGVnb3J5UGFnZVJlc3VsdHNFdmVudCxcbiAgICAgIHRoaXMuYnVpbGRDYXRlZ29yeVJlc3VsdHNQYWdlRXZlbnQoKVxuICAgICk7XG4gIH1cblxuICBwcm90ZWN0ZWQgYnVpbGRQcm9kdWN0RGV0YWlsc1BhZ2VFdmVudCgpOiBPYnNlcnZhYmxlPFxuICAgIFByb2R1Y3REZXRhaWxzUGFnZUV2ZW50XG4gID4ge1xuICAgIHJldHVybiB0aGlzLmV2ZW50U2VydmljZS5nZXQoUGFnZUV2ZW50KS5waXBlKFxuICAgICAgZmlsdGVyKChwYWdlRXZlbnQpID0+IHBhZ2VFdmVudC5zZW1hbnRpY1JvdXRlID09PSAncHJvZHVjdCcpLFxuICAgICAgbWFwKChwYWdlRXZlbnQpID0+IHBhZ2VFdmVudC5jb250ZXh0LmlkKSxcbiAgICAgIHN3aXRjaE1hcCgocHJvZHVjdElkKSA9PlxuICAgICAgICB0aGlzLnByb2R1Y3RTZXJ2aWNlLmdldChwcm9kdWN0SWQpLnBpcGUoXG4gICAgICAgICAgZmlsdGVyKChwcm9kdWN0KSA9PiBCb29sZWFuKHByb2R1Y3QpKSxcbiAgICAgICAgICB0YWtlKDEpLFxuICAgICAgICAgIG1hcCgocHJvZHVjdCkgPT5cbiAgICAgICAgICAgIGNyZWF0ZUZyb20oUHJvZHVjdERldGFpbHNQYWdlRXZlbnQsIHtcbiAgICAgICAgICAgICAgY2F0ZWdvcmllczogcHJvZHVjdC5jYXRlZ29yaWVzLFxuICAgICAgICAgICAgICBjb2RlOiBwcm9kdWN0LmNvZGUsXG4gICAgICAgICAgICAgIG5hbWU6IHByb2R1Y3QubmFtZSxcbiAgICAgICAgICAgICAgcHJpY2U6IHByb2R1Y3QucHJpY2UsXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgICk7XG4gIH1cblxuICBwcm90ZWN0ZWQgYnVpbGRDYXRlZ29yeVJlc3VsdHNQYWdlRXZlbnQoKTogT2JzZXJ2YWJsZTxcbiAgICBDYXRlZ29yeVBhZ2VSZXN1bHRzRXZlbnRcbiAgPiB7XG4gICAgY29uc3Qgc2VhcmNoUmVzdWx0cyQgPSB0aGlzLnByb2R1Y3RTZWFyY2hTZXJ2aWNlLmdldFJlc3VsdHMoKS5waXBlKFxuICAgICAgLy8gc2tpcHBpbmcgdGhlIGluaXRpYWwgdmFsdWUsIGFuZCBwcmV2ZW50aW5nIGVtaXNzaW9uIG9mIHRoZSBwcmV2aW91cyBzZWFyY2ggc3RhdGVcbiAgICAgIHNraXAoMSlcbiAgICApO1xuXG4gICAgY29uc3QgY2F0ZWdvcnlQYWdlRXZlbnQkID0gdGhpcy5ldmVudFNlcnZpY2UuZ2V0KFBhZ2VFdmVudCkucGlwZShcbiAgICAgIG1hcCgocGFnZUV2ZW50KSA9PiAoe1xuICAgICAgICBpc0NhdGVnb3J5UGFnZTogcGFnZUV2ZW50LnNlbWFudGljUm91dGUgPT09ICdjYXRlZ29yeScsXG4gICAgICAgIGNhdGVnb3J5Q29kZTogcGFnZUV2ZW50LmNvbnRleHQuaWQsXG4gICAgICB9KSlcbiAgICApO1xuXG4gICAgcmV0dXJuIGNhdGVnb3J5UGFnZUV2ZW50JC5waXBlKFxuICAgICAgc3dpdGNoTWFwKChwYWdlRXZlbnQpID0+IHtcbiAgICAgICAgaWYgKCFwYWdlRXZlbnQuaXNDYXRlZ29yeVBhZ2UpIHtcbiAgICAgICAgICByZXR1cm4gRU1QVFk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gc2VhcmNoUmVzdWx0cyQucGlwZShcbiAgICAgICAgICBtYXAoKHNlYXJjaFJlc3VsdHMpID0+ICh7XG4gICAgICAgICAgICBjYXRlZ29yeUNvZGU6IHBhZ2VFdmVudC5jYXRlZ29yeUNvZGUsXG4gICAgICAgICAgICBjYXRlZ29yeU5hbWU6IHNlYXJjaFJlc3VsdHMuYnJlYWRjcnVtYnNbMF0uZmFjZXRWYWx1ZU5hbWUsXG4gICAgICAgICAgfSkpLFxuICAgICAgICAgIG1hcCgoY2F0ZWdvcnlQYWdlKSA9PlxuICAgICAgICAgICAgY3JlYXRlRnJvbShDYXRlZ29yeVBhZ2VSZXN1bHRzRXZlbnQsIGNhdGVnb3J5UGFnZSlcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICBwcm90ZWN0ZWQgYnVpbGRTZWFyY2hQYWdlUmVzdWx0c0V2ZW50KCk6IE9ic2VydmFibGU8U2VhcmNoUGFnZVJlc3VsdHNFdmVudD4ge1xuICAgIGNvbnN0IHNlYXJjaFJlc3VsdHMkID0gdGhpcy5wcm9kdWN0U2VhcmNoU2VydmljZS5nZXRSZXN1bHRzKCkucGlwZShcbiAgICAgIC8vIHNraXBwaW5nIHRoZSBpbml0aWFsIHZhbHVlLCBhbmQgcHJldmVudGluZyBlbWlzc2lvbiBvZiB0aGUgcHJldmlvdXMgc2VhcmNoIHN0YXRlXG4gICAgICBza2lwKDEpLFxuICAgICAgbWFwKChzZWFyY2hSZXN1bHRzKSA9PiAoe1xuICAgICAgICBzZWFyY2hUZXJtOiBzZWFyY2hSZXN1bHRzLmZyZWVUZXh0U2VhcmNoLFxuICAgICAgICBudW1iZXJPZlJlc3VsdHM6IHNlYXJjaFJlc3VsdHMucGFnaW5hdGlvbi50b3RhbFJlc3VsdHMsXG4gICAgICB9KSksXG4gICAgICBtYXAoKHNlYXJjaFBhZ2UpID0+IGNyZWF0ZUZyb20oU2VhcmNoUGFnZVJlc3VsdHNFdmVudCwgc2VhcmNoUGFnZSkpXG4gICAgKTtcblxuICAgIGNvbnN0IHNlYXJjaFBhZ2VFdmVudCQgPSB0aGlzLmV2ZW50U2VydmljZVxuICAgICAgLmdldChQYWdlRXZlbnQpXG4gICAgICAucGlwZShtYXAoKHBhZ2VFdmVudCkgPT4gcGFnZUV2ZW50LnNlbWFudGljUm91dGUgPT09ICdzZWFyY2gnKSk7XG5cbiAgICByZXR1cm4gc2VhcmNoUGFnZUV2ZW50JC5waXBlKFxuICAgICAgc3dpdGNoTWFwKChpc1NlYXJjaFBhZ2UpID0+IChpc1NlYXJjaFBhZ2UgPyBzZWFyY2hSZXN1bHRzJCA6IEVNUFRZKSlcbiAgICApO1xuICB9XG59XG4iXX0=